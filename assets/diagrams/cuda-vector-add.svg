<?xml version="1.0" encoding="UTF-8"?>
<svg width="640" height="320" viewBox="0 0 640 320" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="CUDA vector addition data flow">
  <defs>
    <style>
      .title { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; }
      .caption { font-family: 'JetBrains Mono', monospace; font-size: 12px; fill: currentColor; }
      .rect { fill: none; stroke: currentColor; stroke-width: 2; rx: 10; }
      .cell { fill: none; stroke: currentColor; stroke-width: 1.6; rx: 6; }
      .arrow { stroke: currentColor; stroke-width: 1.8; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="3.5" orient="auto">
      <polygon points="0 0, 7 3.5, 0 7" fill="currentColor"/>
    </marker>
  </defs>

  <!-- Host column -->
  <text class="title" x="60" y="40">CPU (Host)</text>
  <rect class="rect" x="40" y="60" width="160" height="70"/>
  <text class="caption" x="55" y="90">h_a = [0, 1, 2, …]</text>
  <rect class="rect" x="40" y="150" width="160" height="70"/>
  <text class="caption" x="55" y="180">h_b = [0, 2, 4, …]</text>
  <rect class="rect" x="40" y="240" width="160" height="60"/>
  <text class="caption" x="55" y="270">h_c = results</text>

  <!-- Arrows to device -->
  <line class="arrow" x1="210" y1="95" x2="300" y2="95"/>
  <line class="arrow" x1="210" y1="185" x2="300" y2="185"/>
  <text class="caption" x="220" y="80">cudaMemcpy</text>

  <!-- Device column -->
  <text class="title" x="360" y="40">GPU (Device)</text>
  <rect class="rect" x="320" y="60" width="180" height="70"/>
  <text class="caption" x="332" y="90">d_a (device copy)</text>
  <rect class="rect" x="320" y="150" width="180" height="70"/>
  <text class="caption" x="332" y="180">d_b (device copy)</text>

  <!-- Kernel box -->
  <rect class="rect" x="320" y="240" width="180" height="60"/>
  <text class="caption" x="332" y="268">vectorAdd kernel</text>
  <text class="caption" x="332" y="290">c[idx] = a[idx] + b[idx]</text>

  <!-- Threads depiction -->
  <g transform="translate(520 80)">
    <text class="title" x="0" y="-20">Threads</text>
    <rect class="cell" x="0" y="0" width="50" height="40"/>
    <rect class="cell" x="60" y="0" width="50" height="40"/>
    <rect class="cell" x="120" y="0" width="50" height="40"/>
    <text class="caption" x="10" y="23">idx 0</text>
    <text class="caption" x="70" y="23">idx 1</text>
    <text class="caption" x="130" y="23">idx 2</text>
    <text class="caption" x="0" y="60">blockIdx · blockDim + threadIdx</text>
  </g>

  <!-- Arrow back to host -->
  <line class="arrow" x1="320" y1="270" x2="210" y2="270"/>
  <text class="caption" x="220" y="255">cudaMemcpy</text>
</svg>
